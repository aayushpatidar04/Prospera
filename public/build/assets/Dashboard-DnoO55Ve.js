import{_ as he}from"./AuthenticatedLayout-UtdDniPL.js";import{g as le,a as x,b as de,h as ve,w as ee,d as L,F as fe,o as pe}from"./app-0ovB2NpX.js";import"./ApplicationLogo-DjfR3GD4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */function we(c){if(Array.isArray(c)){for(var r=0,t=new Array(c.length);r<c.length;r++)t[r]=c[r];return t}}var ge=we;function me(c){if(Symbol.iterator in Object(c)||Object.prototype.toString.call(c)==="[object Arguments]")return Array.from(c)}var ye=me;function Se(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var be=Se;function ke(c){return ge(c)||ye(c)||be()}var Ie=ke;function _e(c,r){return r={exports:{}},c(r,r.exports),r.exports}var Ee=_e(function(c){var r=(function(t){var a=Object.prototype,n=a.hasOwnProperty,e,s=typeof Symbol=="function"?Symbol:{},i=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",v=s.toStringTag||"@@toStringTag";function b(o,u,h,p){var f=u&&u.prototype instanceof K?u:K,S=Object.create(f.prototype),I=new q(p||[]);return S._invoke=oe(o,h,I),S}t.wrap=b;function y(o,u,h){try{return{type:"normal",arg:o.call(u,h)}}catch(p){return{type:"throw",arg:p}}}var g="suspendedStart",U="suspendedYield",k="executing",m="completed",D={};function K(){}function G(){}function C(){}var B={};B[i]=function(){return this};var V=Object.getPrototypeOf,M=V&&V(V(z([])));M&&M!==a&&n.call(M,i)&&(B=M);var N=C.prototype=K.prototype=Object.create(B);G.prototype=N.constructor=C,C.constructor=G,C[v]=G.displayName="GeneratorFunction";function Q(o){["next","throw","return"].forEach(function(u){o[u]=function(h){return this._invoke(u,h)}})}t.isGeneratorFunction=function(o){var u=typeof o=="function"&&o.constructor;return u?u===G||(u.displayName||u.name)==="GeneratorFunction":!1},t.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,C):(o.__proto__=C,v in o||(o[v]="GeneratorFunction")),o.prototype=Object.create(N),o},t.awrap=function(o){return{__await:o}};function W(o){function u(f,S,I,_){var P=y(o[f],o,S);if(P.type==="throw")_(P.arg);else{var E=P.arg,A=E.value;return A&&typeof A=="object"&&n.call(A,"__await")?Promise.resolve(A.__await).then(function(T){u("next",T,I,_)},function(T){u("throw",T,I,_)}):Promise.resolve(A).then(function(T){E.value=T,I(E)},function(T){return u("throw",T,I,_)})}}var h;function p(f,S){function I(){return new Promise(function(_,P){u(f,S,_,P)})}return h=h?h.then(I,I):I()}this._invoke=p}Q(W.prototype),W.prototype[l]=function(){return this},t.AsyncIterator=W,t.async=function(o,u,h,p){var f=new W(b(o,u,h,p));return t.isGeneratorFunction(u)?f:f.next().then(function(S){return S.done?S.value:f.next()})};function oe(o,u,h){var p=g;return function(S,I){if(p===k)throw new Error("Generator is already running");if(p===m){if(S==="throw")throw I;return Z()}for(h.method=S,h.arg=I;;){var _=h.delegate;if(_){var P=X(_,h);if(P){if(P===D)continue;return P}}if(h.method==="next")h.sent=h._sent=h.arg;else if(h.method==="throw"){if(p===g)throw p=m,h.arg;h.dispatchException(h.arg)}else h.method==="return"&&h.abrupt("return",h.arg);p=k;var E=y(o,u,h);if(E.type==="normal"){if(p=h.done?m:U,E.arg===D)continue;return{value:E.arg,done:h.done}}else E.type==="throw"&&(p=m,h.method="throw",h.arg=E.arg)}}}function X(o,u){var h=o.iterator[u.method];if(h===e){if(u.delegate=null,u.method==="throw"){if(o.iterator.return&&(u.method="return",u.arg=e,X(o,u),u.method==="throw"))return D;u.method="throw",u.arg=new TypeError("The iterator does not provide a 'throw' method")}return D}var p=y(h,o.iterator,u.arg);if(p.type==="throw")return u.method="throw",u.arg=p.arg,u.delegate=null,D;var f=p.arg;if(!f)return u.method="throw",u.arg=new TypeError("iterator result is not an object"),u.delegate=null,D;if(f.done)u[o.resultName]=f.value,u.next=o.nextLoc,u.method!=="return"&&(u.method="next",u.arg=e);else return f;return u.delegate=null,D}Q(N),N[v]="Generator",N[i]=function(){return this},N.toString=function(){return"[object Generator]"};function ce(o){var u={tryLoc:o[0]};1 in o&&(u.catchLoc=o[1]),2 in o&&(u.finallyLoc=o[2],u.afterLoc=o[3]),this.tryEntries.push(u)}function H(o){var u=o.completion||{};u.type="normal",delete u.arg,o.completion=u}function q(o){this.tryEntries=[{tryLoc:"root"}],o.forEach(ce,this),this.reset(!0)}t.keys=function(o){var u=[];for(var h in o)u.push(h);return u.reverse(),function p(){for(;u.length;){var f=u.pop();if(f in o)return p.value=f,p.done=!1,p}return p.done=!0,p}};function z(o){if(o){var u=o[i];if(u)return u.call(o);if(typeof o.next=="function")return o;if(!isNaN(o.length)){var h=-1,p=function f(){for(;++h<o.length;)if(n.call(o,h))return f.value=o[h],f.done=!1,f;return f.value=e,f.done=!0,f};return p.next=p}}return{next:Z}}t.values=z;function Z(){return{value:e,done:!0}}return q.prototype={constructor:q,reset:function(o){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(H),!o)for(var u in this)u.charAt(0)==="t"&&n.call(this,u)&&!isNaN(+u.slice(1))&&(this[u]=e)},stop:function(){this.done=!0;var o=this.tryEntries[0],u=o.completion;if(u.type==="throw")throw u.arg;return this.rval},dispatchException:function(o){if(this.done)throw o;var u=this;function h(P,E){return S.type="throw",S.arg=o,u.next=P,E&&(u.method="next",u.arg=e),!!E}for(var p=this.tryEntries.length-1;p>=0;--p){var f=this.tryEntries[p],S=f.completion;if(f.tryLoc==="root")return h("end");if(f.tryLoc<=this.prev){var I=n.call(f,"catchLoc"),_=n.call(f,"finallyLoc");if(I&&_){if(this.prev<f.catchLoc)return h(f.catchLoc,!0);if(this.prev<f.finallyLoc)return h(f.finallyLoc)}else if(I){if(this.prev<f.catchLoc)return h(f.catchLoc,!0)}else if(_){if(this.prev<f.finallyLoc)return h(f.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(o,u){for(var h=this.tryEntries.length-1;h>=0;--h){var p=this.tryEntries[h];if(p.tryLoc<=this.prev&&n.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var f=p;break}}f&&(o==="break"||o==="continue")&&f.tryLoc<=u&&u<=f.finallyLoc&&(f=null);var S=f?f.completion:{};return S.type=o,S.arg=u,f?(this.method="next",this.next=f.finallyLoc,D):this.complete(S)},complete:function(o,u){if(o.type==="throw")throw o.arg;return o.type==="break"||o.type==="continue"?this.next=o.arg:o.type==="return"?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):o.type==="normal"&&u&&(this.next=u),D},finish:function(o){for(var u=this.tryEntries.length-1;u>=0;--u){var h=this.tryEntries[u];if(h.finallyLoc===o)return this.complete(h.completion,h.afterLoc),H(h),D}},catch:function(o){for(var u=this.tryEntries.length-1;u>=0;--u){var h=this.tryEntries[u];if(h.tryLoc===o){var p=h.completion;if(p.type==="throw"){var f=p.arg;H(h)}return f}}throw new Error("illegal catch attempt")},delegateYield:function(o,u,h){return this.delegate={iterator:z(o),resultName:u,nextLoc:h},this.method==="next"&&(this.arg=e),D}},t})(c.exports);try{regeneratorRuntime=r}catch{Function("r","regeneratorRuntime = r")(r)}}),d=Ee;function re(c,r,t,a,n,e,s){try{var i=c[e](s),l=i.value}catch(v){t(v);return}i.done?r(l):Promise.resolve(l).then(a,n)}function De(c){return function(){var r=this,t=arguments;return new Promise(function(a,n){var e=c.apply(r,t);function s(l){re(e,a,n,s,i,"next",l)}function i(l){re(e,a,n,s,i,"throw",l)}s(void 0)})}}var w=De;function Pe(c,r){if(!(c instanceof r))throw new TypeError("Cannot call a class as a function")}var se=Pe;function te(c,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(c,a.key,a)}}function Re(c,r,t){return r&&te(c.prototype,r),t&&te(c,t),c}var ue=Re;function Te(c,r,t){return r in c?Object.defineProperty(c,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):c[r]=t,c}var Ce=Te;function Ne(c){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{},a=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),a.forEach(function(n){Ce(c,n,t[n])})}return c}var Oe=Ne;function R(c){var r=c.method,t=c.path,a=c.body,n=a===void 0?null:a,e=c.headers,s=e===void 0?{}:e,i=c.credentials,l=i===void 0?"same-origin":i,v={method:r,headers:s,credentials:l};return n!==null&&(v.body=JSON.stringify(n),v.headers=Oe({"Content-Type":"application/json"},s)),fetch(t,v).then((function(){var b=w(d.mark(function y(g){return d.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(g.ok){k.next=3;break}return k.next=3,Ue(g);case 3:return k.prev=3,k.next=6,g.json();case 6:return k.abrupt("return",k.sent);case 9:return k.prev=9,k.t0=k.catch(3),k.abrupt("return",null);case 12:case"end":return k.stop()}},y,null,[[3,9]])}));return function(y){return b.apply(this,arguments)}})())}function Ue(c){return F.apply(this,arguments)}function F(){return F=w(d.mark(function c(r){var t,a,n,e,s,i;return d.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.prev=0,v.next=3,r.json();case 3:a=v.sent,n=a.error,e=n===void 0?"Unknown error":n,s=a.description,i=s===void 0?"No description":s,t="Unexpected status code ".concat(r.status,": ").concat(e,", ").concat(i),v.next=14;break;case 11:v.prev=11,v.t0=v.catch(0),t="Unexpected status code ".concat(r.status,": Cannot parse error response");case 14:throw new Error(t);case 15:case"end":return v.stop()}},c,null,[[0,11]])})),F.apply(this,arguments)}var Ae=(function(){function c(r){se(this,c),this._instanceId=r,this._dbConn=null}return ue(c,[{key:"connect",value:function(){var t=this;return new Promise(function(a,n){var e=indexedDB.open(t._dbName);e.onsuccess=function(s){var i=s.target.result;t._dbConn=i,t._readState().then(function(l){return l===null?t.clear():Promise.resolve()}).then(a)},e.onupgradeneeded=function(s){var i=s.target.result;i.createObjectStore("beams",{keyPath:"instance_id"})},e.onerror=function(s){var i=new Error("Database error: ".concat(s.target.error));n(i)}})}},{key:"clear",value:function(){return this._writeState({instance_id:this._instanceId,device_id:null,token:null,user_id:null})}},{key:"_readState",value:function(){var t=this;if(!this.isConnected)throw new Error("Cannot read value: DeviceStateStore not connected to IndexedDB");return new Promise(function(a,n){var e=t._dbConn.transaction("beams").objectStore("beams").get(t._instanceId);e.onsuccess=function(s){var i=s.target.result;i||a(null),a(i)},e.onerror=function(s){n(s.target.error)}})}},{key:"_readProperty",value:(function(){var r=w(d.mark(function a(n){var e;return d.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._readState();case 2:if(e=i.sent,e!==null){i.next=5;break}return i.abrupt("return",null);case 5:return i.abrupt("return",e[n]||null);case 6:case"end":return i.stop()}},a,this)}));function t(a){return r.apply(this,arguments)}return t})()},{key:"_writeState",value:function(t){var a=this;if(!this.isConnected)throw new Error("Cannot write value: DeviceStateStore not connected to IndexedDB");return new Promise(function(n,e){var s=a._dbConn.transaction("beams","readwrite").objectStore("beams").put(t);s.onsuccess=function(i){n()},s.onerror=function(i){e(i.target.error)}})}},{key:"_writeProperty",value:(function(){var r=w(d.mark(function a(n,e){var s;return d.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._readState();case 2:return s=l.sent,s[n]=e,l.next=6,this._writeState(s);case 6:case"end":return l.stop()}},a,this)}));function t(a,n){return r.apply(this,arguments)}return t})()},{key:"getToken",value:function(){return this._readProperty("token")}},{key:"setToken",value:function(t){return this._writeProperty("token",t)}},{key:"getDeviceId",value:function(){return this._readProperty("device_id")}},{key:"setDeviceId",value:function(t){return this._writeProperty("device_id",t)}},{key:"getUserId",value:function(){return this._readProperty("user_id")}},{key:"setUserId",value:function(t){return this._writeProperty("user_id",t)}},{key:"getLastSeenSdkVersion",value:function(){return this._readProperty("last_seen_sdk_version")}},{key:"setLastSeenSdkVersion",value:function(t){return this._writeProperty("last_seen_sdk_version",t)}},{key:"getLastSeenUserAgent",value:function(){return this._readProperty("last_seen_user_agent")}},{key:"setLastSeenUserAgent",value:function(t){return this._writeProperty("last_seen_user_agent",t)}},{key:"_dbName",get:function(){return"beams-".concat(this._instanceId)}},{key:"isConnected",get:function(){return this._dbConn!==null}}]),c})(),O="1.1.0",Le=new RegExp("^(_|\\-|=|@|,|\\.|;|[A-Z]|[a-z]|[0-9])*$"),ne=164,ae=5e3,ie="/service-worker.js?pusherBeamsWebSDKVersion=".concat(O),$=Object.freeze({PERMISSION_PROMPT_REQUIRED:"PERMISSION_PROMPT_REQUIRED",PERMISSION_GRANTED_NOT_REGISTERED_WITH_BEAMS:"PERMISSION_GRANTED_NOT_REGISTERED_WITH_BEAMS",PERMISSION_GRANTED_REGISTERED_WITH_BEAMS:"PERMISSION_GRANTED_REGISTERED_WITH_BEAMS",PERMISSION_DENIED:"PERMISSION_DENIED"}),Ge=(function(){function c(r){if(se(this,c),!r)throw new Error("Config object required");var t=r.instanceId,a=r.endpointOverride,n=a===void 0?null:a,e=r.serviceWorkerRegistration,s=e===void 0?null:e;if(t===void 0)throw new Error("Instance ID is required");if(typeof t!="string")throw new Error("Instance ID must be a string");if(t.length===0)throw new Error("Instance ID cannot be empty");if(!("indexedDB"in window))throw new Error("Pusher Beams does not support this browser version (IndexedDB not supported)");if(!window.isSecureContext)throw new Error("Pusher Beams relies on Service Workers, which only work in secure contexts. Check that your page is being served from localhost/over HTTPS");if(!("serviceWorker"in navigator))throw new Error("Pusher Beams does not support this browser version (Service Workers not supported)");if(!("PushManager"in window))throw new Error("Pusher Beams does not support this browser version (Web Push not supported)");if(s){var i=s.scope,l=window.location.href,v=l.startsWith(i);if(!v)throw new Error("Could not initialize Pusher web push: current page not in serviceWorkerRegistration scope (".concat(i,")"))}this.instanceId=t,this._deviceId=null,this._token=null,this._userId=null,this._serviceWorkerRegistration=s,this._deviceStateStore=new Ae(t),this._endpoint=n,this._ready=this._init()}return ue(c,[{key:"_init",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._deviceId===null){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._deviceStateStore.connect();case 4:if(!this._serviceWorkerRegistration){e.next=9;break}return e.next=7,window.navigator.serviceWorker.ready;case 7:e.next=12;break;case 9:return e.next=11,Me();case 11:this._serviceWorkerRegistration=e.sent;case 12:return e.next=14,this._detectSubscriptionChange();case 14:return e.next=16,this._deviceStateStore.getDeviceId();case 16:return this._deviceId=e.sent,e.next=19,this._deviceStateStore.getToken();case 19:return this._token=e.sent,e.next=22,this._deviceStateStore.getUserId();case 22:this._userId=e.sent;case 23:case"end":return e.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_resolveSDKState",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ready;case 2:return e.next=4,this._detectSubscriptionChange();case 4:case"end":return e.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_detectSubscriptionChange",value:(function(){var r=w(d.mark(function a(){var n,e,s;return d.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._deviceStateStore.getToken();case 2:return n=l.sent,l.next=5,We(this._serviceWorkerRegistration);case 5:if(e=l.sent,s=n!==e,!s){l.next=13;break}return l.next=10,this._deviceStateStore.clear();case 10:this._deviceId=null,this._token=null,this._userId=null;case 13:case"end":return l.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"getDeviceId",value:(function(){var r=w(d.mark(function a(){var n=this;return d.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this._resolveSDKState();case 2:return s.abrupt("return",this._ready.then(function(){return n._deviceId}));case 3:case"end":return s.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"getToken",value:(function(){var r=w(d.mark(function a(){var n=this;return d.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this._resolveSDKState();case 2:return s.abrupt("return",this._ready.then(function(){return n._token}));case 3:case"end":return s.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"getUserId",value:(function(){var r=w(d.mark(function a(){var n=this;return d.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,this._resolveSDKState();case 2:return s.abrupt("return",this._ready.then(function(){return n._userId}));case 3:case"end":return s.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_throwIfNotStarted",value:function(t){if(!this._deviceId)throw new Error("".concat(t,". SDK not registered with Beams. Did you call .start?"))}},{key:"start",value:(function(){var r=w(d.mark(function a(){var n,e,s,i;return d.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,this._resolveSDKState();case 2:if(j()){v.next=4;break}return v.abrupt("return",this);case 4:if(this._deviceId===null){v.next=6;break}return v.abrupt("return",this);case 6:return v.next=8,this._getPublicKey();case 8:return n=v.sent,e=n.vapidPublicKey,v.next=12,this._getPushToken(e);case 12:return s=v.sent,v.next=15,this._registerDevice(s);case 15:return i=v.sent,v.next=18,this._deviceStateStore.setToken(s);case 18:return v.next=20,this._deviceStateStore.setDeviceId(i);case 20:return v.next=22,this._deviceStateStore.setLastSeenSdkVersion(O);case 22:return v.next=24,this._deviceStateStore.setLastSeenUserAgent(window.navigator.userAgent);case 24:return this._token=s,this._deviceId=i,v.abrupt("return",this);case 27:case"end":return v.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"getRegistrationState",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resolveSDKState();case 2:if(Notification.permission!=="denied"){e.next=4;break}return e.abrupt("return",$.PERMISSION_DENIED);case 4:if(!(Notification.permission==="granted"&&this._deviceId!==null)){e.next=6;break}return e.abrupt("return",$.PERMISSION_GRANTED_REGISTERED_WITH_BEAMS);case 6:if(!(Notification.permission==="granted"&&this._deviceId===null)){e.next=8;break}return e.abrupt("return",$.PERMISSION_GRANTED_NOT_REGISTERED_WITH_BEAMS);case 8:return e.abrupt("return",$.PERMISSION_PROMPT_REQUIRED);case 9:case"end":return e.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"addDeviceInterest",value:(function(){var r=w(d.mark(function a(n){var e,s;return d.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not add Device Interest"),Y(n),e="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests/").concat(encodeURIComponent(n)),s={method:"POST",path:e},l.next=8,R(s);case 8:case"end":return l.stop()}},a,this)}));function t(a){return r.apply(this,arguments)}return t})()},{key:"removeDeviceInterest",value:(function(){var r=w(d.mark(function a(n){var e,s;return d.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not remove Device Interest"),Y(n),e="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests/").concat(encodeURIComponent(n)),s={method:"DELETE",path:e},l.next=8,R(s);case 8:case"end":return l.stop()}},a,this)}));function t(a){return r.apply(this,arguments)}return t})()},{key:"getDeviceInterests",value:(function(){var r=w(d.mark(function a(){var n,e;return d.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not get Device Interests"),n="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests"),e={method:"GET",path:n},i.next=7,R(e);case 7:if(i.t0=i.sent.interests,i.t0){i.next=10;break}i.t0=[];case 10:return i.abrupt("return",i.t0);case 11:case"end":return i.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"setDeviceInterests",value:(function(){var r=w(d.mark(function a(n){var e,s,i,l,v,b,y,g,U;return d.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._resolveSDKState();case 2:if(this._throwIfNotStarted("Could not set Device Interests"),n!=null){m.next=5;break}throw new Error("interests argument is required");case 5:if(Array.isArray(n)){m.next=7;break}throw new Error("interests argument must be an array");case 7:if(!(n.length>ae)){m.next=9;break}throw new Error("Number of interests (".concat(n.length,") exceeds maximum of ").concat(ae));case 9:for(e=!0,s=!1,i=void 0,m.prev=12,l=n[Symbol.iterator]();!(e=(v=l.next()).done);e=!0)b=v.value,Y(b);m.next=20;break;case 16:m.prev=16,m.t0=m.catch(12),s=!0,i=m.t0;case 20:m.prev=20,m.prev=21,!e&&l.return!=null&&l.return();case 23:if(m.prev=23,!s){m.next=26;break}throw i;case 26:return m.finish(23);case 27:return m.finish(20);case 28:return y=Array.from(new Set(n)),g="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/interests"),U={method:"PUT",path:g,body:{interests:y}},m.next=33,R(U);case 33:case"end":return m.stop()}},a,this,[[12,16,20,28],[21,,23,27]])}));function t(a){return r.apply(this,arguments)}return t})()},{key:"clearDeviceInterests",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resolveSDKState();case 2:return this._throwIfNotStarted("Could not clear Device Interests"),e.next=5,this.setDeviceInterests([]);case 5:case"end":return e.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"setUserId",value:(function(){var r=w(d.mark(function a(n,e){var s,i,l,v,b;return d.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._resolveSDKState();case 2:if(j()){g.next=4;break}return g.abrupt("return");case 4:if(this._deviceId!==null){g.next=7;break}return s=new Error(".start must be called before .setUserId"),g.abrupt("return",Promise.reject(s));case 7:if(typeof n=="string"){g.next=9;break}throw new Error("User ID must be a string (was ".concat(n,")"));case 9:if(n!==""){g.next=11;break}throw new Error("User ID cannot be the empty string");case 11:if(!(this._userId!==null&&this._userId!==n)){g.next=13;break}throw new Error("Changing the `userId` is not allowed.");case 13:return i="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/user"),g.next=16,e.fetchToken(n);case 16:return l=g.sent,v=l.token,b={method:"PUT",path:i,headers:{Authorization:"Bearer ".concat(v)}},g.next=21,R(b);case 21:return this._userId=n,g.abrupt("return",this._deviceStateStore.setUserId(n));case 23:case"end":return g.stop()}},a,this)}));function t(a,n){return r.apply(this,arguments)}return t})()},{key:"stop",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resolveSDKState();case 2:if(j()){e.next=4;break}return e.abrupt("return");case 4:if(this._deviceId!==null){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this._deleteDevice();case 8:return e.next=10,this._deviceStateStore.clear();case 10:this._clearPushToken().catch(function(){}),this._deviceId=null,this._token=null,this._userId=null;case 14:case"end":return e.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"clearAllState",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(j()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.stop();case 4:return e.next=6,this.start();case 6:case"end":return e.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_getPublicKey",value:(function(){var r=w(d.mark(function a(){var n,e;return d.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/web-vapid-public-key"),e={method:"GET",path:n},i.abrupt("return",R(e));case 3:case"end":return i.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_getPushToken",value:(function(){var r=w(d.mark(function a(n){var e;return d.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,this._clearPushToken();case 3:return i.next=5,this._serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:je(n)});case 5:return e=i.sent,i.abrupt("return",btoa(JSON.stringify(e)));case 9:return i.prev=9,i.t0=i.catch(0),i.abrupt("return",Promise.reject(i.t0));case 12:case"end":return i.stop()}},a,this,[[0,9]])}));function t(a){return r.apply(this,arguments)}return t})()},{key:"_clearPushToken",value:(function(){var r=w(d.mark(function a(){return d.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.serviceWorker.ready.then(function(s){return s.pushManager.getSubscription()}).then(function(s){s&&s.unsubscribe()}));case 1:case"end":return e.stop()}},a)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_registerDevice",value:(function(){var r=w(d.mark(function a(n){var e,s,i,l;return d.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return e="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web"),s={token:n,metadata:{sdkVersion:O}},i={method:"POST",path:e,body:s},b.next=5,R(i);case 5:return l=b.sent,b.abrupt("return",l.id);case 7:case"end":return b.stop()}},a,this)}));function t(a){return r.apply(this,arguments)}return t})()},{key:"_deleteDevice",value:(function(){var r=w(d.mark(function a(){var n,e;return d.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return n="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(encodeURIComponent(this._deviceId)),e={method:"DELETE",path:n},i.next=4,R(e);case 4:case"end":return i.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_updateDeviceMetadata",value:(function(){var r=w(d.mark(function a(){var n,e,s,i,l,v;return d.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return n=window.navigator.userAgent,y.next=3,this._deviceStateStore.getLastSeenUserAgent();case 3:return e=y.sent,y.next=6,this._deviceStateStore.getLastSeenSdkVersion();case 6:if(s=y.sent,!(n===e&&O===s)){y.next=9;break}return y.abrupt("return");case 9:return i="".concat(this._baseURL,"/device_api/v1/instances/").concat(encodeURIComponent(this.instanceId),"/devices/web/").concat(this._deviceId,"/metadata"),l={sdkVersion:O},v={method:"PUT",path:i,body:l},y.next=14,R(v);case 14:return y.next=16,this._deviceStateStore.setLastSeenSdkVersion(O);case 16:return y.next=18,this._deviceStateStore.setLastSeenUserAgent(n);case 18:case"end":return y.stop()}},a,this)}));function t(){return r.apply(this,arguments)}return t})()},{key:"_baseURL",get:function(){return this._endpoint!==null?this._endpoint:"https://".concat(this.instanceId,".pushnotifications.pusher.com")}}]),c})(),Y=function(r){if(r==null)throw new Error("Interest name is required");if(typeof r!="string")throw new Error("Interest ".concat(r," is not a string"));if(!Le.test(r))throw new Error('interest "'.concat(r,'" contains a forbidden character. ')+"Allowed characters are: ASCII upper/lower-case letters, numbers or one of _-=@,.;");if(r.length>ne)throw new Error("Interest is longer than the maximum of ".concat(ne," chars"))};function Me(){return J.apply(this,arguments)}function J(){return J=w(d.mark(function c(){var r,t;return d.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(ie);case 2:if(r=n.sent,t=r.status,t===200){n.next=6;break}throw new Error("Cannot start SDK, service worker missing: No file found at /service-worker.js");case 6:return window.navigator.serviceWorker.register(ie,{updateViaCache:"none"}),n.abrupt("return",window.navigator.serviceWorker.ready);case 8:case"end":return n.stop()}},c)})),J.apply(this,arguments)}function We(c){return c.pushManager.getSubscription().then(function(r){return r?$e(r):null})}function $e(c){return btoa(JSON.stringify(c))}function je(c){var r="=".repeat((4-c.length%4)%4),t=(c+r).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(t);return Uint8Array.from(Ie(a).map(function(n){return n.charCodeAt(0)}))}function j(){var c=window.navigator,r=c.vendor,t=window.chrome!==null&&typeof window.chrome<"u",a=c.userAgent.indexOf("OPR")>-1,n=c.userAgent.indexOf("Edg")>-1,e=c.userAgent.indexOf("Firefox")>-1,s=t&&r==="Google Inc."&&!n&&!a,i=s||a||e||n;return i||console.warn("Pusher Web Push Notifications supports Chrome, Firefox, Edge and Opera."),i}const ze={__name:"Dashboard",setup(c){const r=new Ge({instanceId:"becc7936-b48d-4ce6-8c1f-eb84f793b4fc"});return r.start().then(()=>r.addDeviceInterest("hello")).then(()=>console.log("Successfully registered and subscribed!")).catch(console.error),(t,a)=>(pe(),le(fe,null,[x(de(ve),{title:"Dashboard"}),x(he,null,{header:ee(()=>[...a[0]||(a[0]=[L("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Dashboard ",-1)])]),default:ee(()=>[a[1]||(a[1]=L("div",{class:"py-12"},[L("div",{class:"mx-auto max-w-7xl sm:px-6 lg:px-8"},[L("div",{class:"overflow-hidden bg-white shadow-sm sm:rounded-lg"},[L("div",{class:"p-6 text-gray-900"}," You're logged in! ")])])],-1))]),_:1})],64))}};export{ze as default};
